"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Color=function(){function t(i){this.hex=i,this.rgb=t.toRGB(i),this.alpha=1}return t.toRGB=function(t){if(3===(t="#"===t.charAt(0)?t.substr(1):t).length){for(var i="",o=0;o<t.length;o++)i+=t[o]+t[o];t=i}return 6===t.length?[parseInt(t.substr(0,2),16),parseInt(t.substr(2,2),16),parseInt(t.substr(4,2),16)]:[]},t.prototype.toRGBAString=function(){return"rgba("+this.rgb.join(", ")+", "+this.alpha+")"},t}();Math.randrange=function(t,i){return void 0!==i&&null!==i||(i=t,t=0),Math.random()*(i-t)+t},Math.randint=function(t,i){return Math.floor(Math.random()*(i-t+1))+t},Math.PI2=Math.PI/2;var Particle=function(){function t(i,o){var e=this;e.options=Util.extend({},t.defaultOptions,o),e.ctx=i,e.x=e.oldX=e.options.x,e.y=e.oldY=e.options.y,e.v=e.options.v.clone(),e.lifetime=e.options.lifetime,e.gravity=e.options.gravity,e.width=e.options.width,e.border=null,e.color=new Color(e.options.color),e.setBorder(e.options.border)}return t.Damp=.999,t.Gravity=.3,t.MaxSpeed=20,t.defaultOptions={x:0,y:0,v:new Vector2,lifetime:60,gravity:1,width:2,border:{width:0,color:"#f00"},color:"#fff",animate:{alpha:{from:1,to:.2}}},t.prototype.setBorder=function(t){this.border={width:t.width,strokeWidth:this.width+2*t.width,color:new Color(t.color)}},t.prototype.update=function(){var i=this;return i.lifetime--,i.lifetime<=0?(i.reset(),!0):(i.v.scale(t.Damp),i.v.limit(t.MaxSpeed),i.gravity&&i.applyGravity(),i.oldX=i.x,i.oldY=i.y,i.x+=i.v.x,i.y+=i.v.y,!1)},t.prototype.applyGravity=function(){this.v.add(0,t.Gravity*this.gravity)},t.prototype.render=function(){var t=this;if(t.options.animate)for(var i in t.options.animate)if(t.options.animate.hasOwnProperty(i)){var o=t["animate"+i.capitalize()].bind(t);"function"==typeof o&&o()}t.ctx.beginPath(),t.ctx.moveTo(t.oldX,t.oldY),t.ctx.lineTo(t.x,t.y),t.border.width>0&&(t.ctx.lineWidth=t.border.strokeWidth,t.ctx.strokeStyle=t.border.color.toRGBAString(),t.ctx.stroke()),t.ctx.lineWidth=t.options.width,t.ctx.strokeStyle=t.color.toRGBAString(),t.ctx.stroke()},t.prototype.reset=function(){var t=this;t.x=t.oldX=t.options.x,t.y=t.oldY=t.options.y,t.v.set(t.options.v),t.lifetime=t.options.lifetime},t.prototype.animateAlpha=function(){var t=this.options.animate.alpha.from,i=t+(this.options.animate.alpha.to-t)*(1-this.lifetime/this.options.lifetime);this.options.border.color.alpha=i,this.options.color.alpha=i,this.ctx.globalAlpha=i},t}(),ParticleSpawner=function(){function t(i,o){if(this.ctx=i,this.options=Util.extend({},t.defaultOptions,o),this.particles=[],this.isPlaying=!1,this.isSpawning=!1,this.framesTillNextSpawn=0,0===this.options.spawnDelay.value)for(var e=0;e<this.options.maxParticles;e++)this.spawnParticle()}function i(t){return t.value+Math.randrange(t.jitter)-t.jitter/2}return t.prototype.spawnParticle=function(){if(!this.isSpawning)return!1;var t=this.options.particle,o=i(t.v),e=i(t.angle),n=o*Math.cos(e),r=o*Math.sin(e),a=new Vector2(n,r);return this.particles.push(new Particle(this.ctx,{x:i(t.x),y:i(t.y),v:a,lifetime:i(t.lifetime),gravity:i(t.gravity),border:{width:i(t.border.width),color:t.border.color.value},width:i(t.width),color:t.color.value})),!0},t.prototype.update=function(){var t=this;t.isPlaying&&(t.framesTillNextSpawn>0?t.framesTillNextSpawn--:0===t.framesTillNextSpawn&&t.particles.length<t.options.maxParticles&&(t.spawnParticle(),t.framesTillNextSpawn=Math.round(i(t.options.spawnDelay))),t.particles.forEach(function(o,e){o.update()&&!t.isSpawning&&(delete t.particles[e],t.particles.splice(e,1),t.framesTillNextSpawn<0&&(t.framesTillNextSpawn=Math.round(i(t.options.spawnDelay))))}))},t.prototype.render=function(){this.isPlaying&&(this.ctx.lineCap="round",this.particles.forEach(function(t){t.render()}))},t.prototype.play=function(){return this.isPlaying=!0,this.playSpawning(),this},t.prototype.pause=function(){return this.isPlaying=!1,this.pauseSpawning(),this},t.prototype.stop=function(){this.isPlaying=!1,this.pauseSpawning(),this.particles.forEach(function(t){t.reset()})},t.prototype.pauseSpawning=function(){this.isSpawning=!1},t.prototype.playSpawning=function(){this.isSpawning=!0},t.defaultOptions={maxParticles:300,spawnDelay:{value:1,jitter:0},particle:{x:{value:0,jitter:0},y:{value:0,jitter:0},v:{value:10,jitter:1},angle:{value:-Math.PI2,jitter:.8},lifetime:{value:60,jitter:10},gravity:{value:1,jitter:.2},width:{value:2,jitter:0},border:{width:{value:0,jitter:0},color:{value:"#f00"}},color:{value:"#fff"}}},t}();String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.substring(1)};var Util={extend:function(){var t=arguments[0],i=void 0,o=void 0,e=void 0;"object"!==(void 0===t?"undefined":_typeof(t))&&(t={});for(var n=1;n<arguments.length;n++){i=arguments[n];for(o in i)i.hasOwnProperty(o)&&("object"===(void 0===(e=i[o])?"undefined":_typeof(e))?(t[o]||(t[o]=new e.constructor),Util.extend(t[o],e)):t[o]=e)}return t}},Vector2=function(){function t(t,i){this.x=t||0,this.y=i||0}return t.prototype.set=function(t){this.x=t.x,this.y=t.y},t.prototype.add=function(t,i){return void 0!==i&&"number"==typeof t&&"number"==typeof i?(this.x+=t,this.y+=i):(this.x+=t.x,this.y+=t.y),this},t.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.scale=function(t){return this.x*=t,this.y*=t,this},t.prototype.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.toLength=function(t){var i=t/this.getLength();return this.x*=i,this.y*=i,this},t.prototype.limit=function(t){var i=this.getLength();if(i>Particle.MaxSpeed){var o=t/i;this.x*=o,this.y*=o}return this},t.prototype.normalize=function(){var t=this.getLength();return this.x*=this.x/t,this.y*=this.y/t,this},t.prototype.clone=function(){return new t(this.x,this.y)},t}();